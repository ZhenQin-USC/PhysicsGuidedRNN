# Physics-Guided Deep Learning for Prediction of Energy Production from Geothermal Reservoirs
As efficient alternatives to traditional physics-based simulation, data-driven predictive models such as deep learning-based models can provide fast prediction and facilitate complex iterative tasks that entail high runtime. However, purely data-driven models trained using limited data often provides physically inconsistent predictions and fails to generalize beyond the training data. It has important consequences in optimization applications with a high-dimensional input space since the control strategies are likely to fall beyond the training data during the optimization process. These limitations undermine their suitability and strength in scientific and engineering applications, where the amount of data is typically limited but physical laws are well-established and frequently used. 

To address the above challenges and learn the unknown physical system, we propose a novel physics-guided machine learning model by partially incorporating the physics into deep learning models. A typical approach of the incorporation of physics is adding a physics-informed constraint in loss function to regularize the trainable parameters. However, this approach requires known physical equations and does not explore the interpretability of the architecture of the neural network. In this work, the architecture of the proposed recurrent neural networks (RNN) is designed to represent the differential equations of the subsurface system. We present the physics guided RNN models in detail and demonstrate their connection with differential equations. We investigate the prediction performance of proposed models by first applying them to a toy example to evaluate its capability of extrapolation. The physics guided RNNs are then applied to the simulated dataset generated by a field-scale geothermal reservoir model and to the field data. 



## Mehodology

### 1. Skip Connection:
<p align="center">
<img src="https://github.com/ZhenQin-USC/PhysicsGuidedRNN/blob/main/Image/SkipConnection.png" width="825" height="300">
</p>

### 2. Physics Guided RNNs:

#### 2.1 Physics Guided GRU:
<p align="center">
<img src="https://github.com/ZhenQin-USC/PhysicsGuidedRNN/blob/main/Image/PhyGRU.png" width="825" height="200">
</p>

#### 2.1 Physics Guided RNN:
<p align="center">
<img src="https://github.com/ZhenQin-USC/PhysicsGuidedRNN/blob/main/Image/PhyRNN.png" width="825" height="200">
</p>



## Prerequisite
Python 3.9.7

Tensorflow 2.6.0



## Data
Due to the data confidentiality, we are not allowed to share the field examples or simulation model that were used in our paper. Only the synthetic examples are available in this repository.



## Acknowledgments
This material is based upon work supported by the U.S. Department of Energy's Office of Energy Efficiency and Renewable Energy (EERE) under the Geothermal Technologies Office award number DE-EE0008765. The authors acknowledge the Energi Simulation support of the Center for Reservoir Characterization and Forecasting at USC.





